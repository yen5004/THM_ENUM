# Basic Authentication in 2k24?
Basic authentication offers a more straightforward method when securing access to devices. It requires only a username and password, making it easy to implement and manage on devices with limited processing capabilities. Network devices such as routers typically utilise basic authentication to control access to their administrative interfaces. In this scenario, the primary goal is to prevent unauthorized access with minimal setup.

While basic authentication does not offer the robust security features provided by more complex schemes like OAuth or token-based authentication, its simplicity makes it suitable for environments where session management and user tracking are not required or are managed differently. For example, in devices like routers that are primarily accessed for configuration changes rather than regular use, the overhead of maintaining session states is unnecessary and could complicate device performance.

HTTP Basic Authentication is defined in RFC 7617, which specifies that the credentials (username and password) should be transported as a base64-encoded string within the HTTP Authorization header. This method is straightforward but not secure over non-HTTPS connections, as base64 is not an encryption method and can be easily decoded. The real threat often comes from weak credentials that can be brute-forced.

HTTP Basic Authentication provides a simple challenge-response mechanism for requesting user credentials.

|![image](https://github.com/user-attachments/assets/f36cefbd-2e27-4909-b55d-84aab12226f1)|
|---|
|Basic authentication login process|

https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication

The Authorization header format is as follows:
```bash
Authorization: Basic <credentials>
```
where **`<credentials>`** is the base64 encoding of **`username:password`**. For detailed specifications, refer to [RFC 7617](https://tools.ietf.org/html/rfc7617).

## Exploitation
To demonstrate this, go to http://enum.thm/labs/basic_auth/.
|![image](https://github.com/user-attachments/assets/4dc0e0cc-a72b-4876-892a-329fe40641cb)|
|---|
|Basic Authentication Lab Homepage|

Input any username and password in the pop-up and capture the Basic Auth Request using Burp.
|![image](https://github.com/user-attachments/assets/7879b40c-c179-4a59-8070-7c9084ec49ab)|
|---|
|Random login credentials in the popup||

|![image](https://github.com/user-attachments/assets/6a8294e2-bea8-44cb-b566-16237913373d)|
|---|
|Encoded login credentials in the HTTP Request Header|

Right-click the request and send it to Intruder.
|![image](https://github.com/user-attachments/assets/31d22cb2-15f3-435b-873b-d6b15dc5ba50)|
|---|
|Captured request context menu|

In Burp Intruder, go to the "Positions" tab and decode the base64 encoded string in the Authorization header.
|![image](https://github.com/user-attachments/assets/0a2fe320-886d-4b5d-8b87-3e5a8599e535)|
|---|
|Decoded base64 encoded string|

Once decoded, highlight the decoded string and click the Add button in the top right corner.
|![image](https://github.com/user-attachments/assets/2282db87-d377-4759-83cb-ccb0e3bf5081)|
|---|
|Highlighted text with a payload highlight|

Next is configuring the payloads. Go to the Payloads tab and set the payload type to Simple list and choose your preferred wordlist. In this demo, we will use the [500-worst-passwords.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/500-worst-passwords.txt) from SecLists. If you're using the AttackBox, you may use the same wordlist located at **`/usr/share/wordlists/SecLists/Passwords/Common-Credentials/500-worst-passwords.txt`**.
|![image](https://github.com/user-attachments/assets/5f5fba83-00f1-4823-90db-02fd40f4c857)|
|---|
|Choosing a wordlist|

Since the header is base64 encoded, we need to add two rules in the Payload processing section. The first automatically adds a username to the password, so instead of **123456**, the payload will be **"admin:123456"**.
|![image](https://github.com/user-attachments/assets/24af0701-b13b-4647-ae56-266a26ebe4bc)|
|---|
|First payload processing rule|

The second rule will base64 encode the combined username and password from the supplied list.
|![image](https://github.com/user-attachments/assets/8ed3b51e-7fc8-47b9-81a6-0692d0546da9)|
|---|
|Second payload processing rule|

üö®üö®üö® 
```diff
- We should also remove the character "=" (equal sign) from the encoding because base64 uses "=" for padding.
- To do this, scroll down and remove the "=" sign from the list of characters in the Payload encoding section.
```
|![image](https://github.com/user-attachments/assets/cdef0fba-e3a7-483f-b89e-73bade5d8b66)|
|---|
|Removing the equal sign due to padding|

Once done, go back to the Positions tab and click the Start Attack button. The attack will take a little less than 2 minutes.
|![image](https://github.com/user-attachments/assets/8c085883-0ce6-4543-94ce-11f130158af8)|
|---|
|Starting the attack|

Once you get a Status code 200, it means the brute force is successful, and one of the passwords in the supplied list is working. Decode the encoded base64 string in the successful request.
|![image](https://github.com/user-attachments/assets/39a44e6f-85cf-4f6c-9902-039b7c6ef90d)|
|---|
|Decoding the payload of the successful request|

|![image](https://github.com/user-attachments/assets/15360ba2-5ac5-4222-9687-d933e2640ae6)|
|---|
|Decoded value of the base64 string|

Using the credentials to login
|![image](https://github.com/user-attachments/assets/62e26f61-621a-4a1d-b919-caf887f74970)|
|---|
|Use the decoded base64 string to log into the application.|


|![image](https://github.com/user-attachments/assets/3dbabfe1-9868-41c0-8f30-fb78d5a6fcf1)|
|---|
|Flag in the dashboard|

üèÅüèÅüèÅ
